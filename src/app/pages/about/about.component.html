<!-- SECTIONS UI (same as before) -->
<div class="content">
  <div class="container-fluid pt-4 px-4">
    <div
      class="mb-3 text-end d-flex align-items-center justify-content-between">
      <h3>About Page (CMS)</h3>
      <button class="btn btn-sm btn-danger" (click)="openForm()"><i
          class="fa fa-plus"></i> Add Record</button>
    </div>

    <!-- Section Form Modal -->
    <div class="modal-backdrop" *ngIf="showFormModal"></div>
    <div class="modal d-block" *ngIf="showFormModal" tabindex="-1"
      role="dialog">
      <div class="modal-dialog">
        <div class="modal-content bg-secondary rounded h-100 p-4">
          <div class="modal-header">
            <h5 class="modal-title">{{ editingId ? 'Edit' : 'Add' }} About
              Content</h5>
            <button type="button" class="btn btn-square btn-outline-primary m-2"
              (click)="closeForm()"><i class="fa fa-times"></i></button>
          </div>
          <div class="modal-body">
            <form [formGroup]="aboutForm" (ngSubmit)="onSubmit()">
              <div class="mb-3">
                <label class="form-label">Section Key</label>
                <select class="form-control" formControlName="section_key">
                  <option value>Select Section</option>
                  <option value="section1">Section 1</option>
                  <option value="section2">Section 2</option>
                </select>
                <div
                  *ngIf="aboutForm.get('section_key')?.invalid && (aboutForm.get('section_key')?.dirty || aboutForm.get('section_key')?.touched)"
                  class="text-danger mt-1">Section is required.</div>
              </div>

              <div class="mb-3">
                <label class="form-label">Header Name</label>
                <input class="form-control" formControlName="header_name" />
                <div
                  *ngIf="aboutForm.get('header_name')?.invalid && (aboutForm.get('header_name')?.dirty || aboutForm.get('header_name')?.touched)"
                  class="text-danger mt-1">Header Name is required.</div>
              </div>

              <div class="mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" formControlName="description"
                  rows="3"></textarea>
                <div
                  *ngIf="aboutForm.get('description')?.invalid && (aboutForm.get('description')?.dirty || aboutForm.get('description')?.touched)"
                  class="text-danger mt-1">Description is required.</div>
              </div>

              <div class="mb-3">
                <label class="form-label">Upload File (only for Section
                  1)</label>
                <input type="file" (change)="onFileChange($event)"
                  class="form-control" />
                <div *ngIf="editingId && !selectedFile && editingFilePreview">
                  <p class="mt-2">Current File:</p>
                  <img
                    [src]="apiService.getBaseUrl() + '/' + editingFilePreview"
                    width="80" class="rounded border" />
                </div>
              </div>

              <div class="mb-3 form-check">
                <input type="checkbox" class="form-check-input"
                  formControlName="status" id="statusCheck" />
                <label class="form-check-label" for="statusCheck">Status</label>
              </div>

              <div class="d-flex align-items-center justify-content-center">
                <button type="submit" class="btn btn-primary"
                  [disabled]="aboutForm.invalid">{{ editingId ? 'Update' :
                  'Submit' }}</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Sections List -->
    <div class="bg-secondary text-center rounded p-4">
      <div class="d-flex align-items-center justify-content-between mb-4">
        <h6 class="mb-0">List View</h6>
        <a (click)="loadContents()" class="refresh-btn"
          style="cursor:pointer">Refresh</a>
      </div>

      <div class="table-responsive">
        <table
          class="table text-start align-middle table-bordered table-hover mb-0">
          <thead>
            <tr class="text-white">
              <th>#</th>
              <th>Section Key</th>
              <th>Header Name</th>
              <th>Description</th>
              <th>File</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of homeContents; let i = index">
              <td>{{ i + 1 }}</td>
              <td>{{ item.section_key }}</td>
              <td>{{ item.header_name }}</td>
              <td>{{ item.description }}</td>
              <td><img *ngIf="item.file_path"
                  [src]="apiService.getBaseUrl() + '/' + item.file_path"
                  width="80" /></td>
              <td>{{ item.status == 1 ? 'Active' : 'Inactive' }}</td>
              <td class="d-flex gap-2">
                <button class="btn btn-sm btn-warning"
                  (click)="editContent(item)"><i
                    class="fa fa-edit"></i></button>
                <button class="btn btn-sm btn-info"
                  (click)="openItemsForSection(item)"><i class="fa fa-list"></i>
                  Items</button>
                <button class="btn btn-sm btn-danger"
                  (click)="openDeleteConfirm(item.id)"><i
                    class="fa fa-trash"></i></button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Delete confirmation for sections -->
    <div *ngIf="confirmDeleteId !== null" class="confirm-overlay">
      <div class="confirm-box">
        <p>Are you sure you want to delete this content?</p>
        <button (click)="confirmDelete()"
          class="btn btn-sm btn-success">Yes</button>
        <button (click)="cancelDelete()"
          class="btn btn-sm btn-danger">No</button>
      </div>
    </div>

    <!-- ---------------- Items Modal ---------------- -->
    <div class="modal-backdrop" *ngIf="showItemsModal"></div>
    <div class="modal d-block" *ngIf="showItemsModal" tabindex="-1"
      role="dialog">
      <div class="modal-dialog modal-lg">
        <div class="modal-content bg-secondary rounded h-100 p-4">
          <div class="modal-header">
            <h5 class="modal-title">Items for: {{
              currentSectionForItems?.header_name }}</h5>
            <button type="button" class="btn btn-square btn-outline-primary m-2"
              (click)="closeItemsModal()"><i class="fa fa-times"></i></button>
          </div>

          <div class="modal-body">
            <div class="d-flex justify-content-between mb-3">
              <h6>Items</h6>
              <div>
                <button class="btn btn-sm btn-danger" (click)="openAddItem()"><i
                    class="fa fa-plus"></i> Add Item</button>
              </div>
            </div>

            <!-- Items Table -->
            <div class="table-responsive mb-3">
              <table class="table table-bordered table-hover">
                <thead>
                  <tr class="text-white">
                    <th>#</th>
                    <th>Icon</th>
                    <th>Subtitle</th>
                    <th>Description</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let it of itemsForSection; let idx = index">
                    <td>{{ idx + 1 }}</td>
                    <td><i [class]="'fa ' + it.icon"></i> {{ it.icon }}</td>
                    <td>{{ it.subtitle }}</td>
                    <td>{{ it.description }}</td>
                    <td>{{ it.status == 1 ? 'Active' : 'Inactive' }}</td>
                    <td class="d-flex gap-2">
                      <button class="btn btn-sm btn-warning"
                        (click)="editItem(it)"><i
                          class="fa fa-edit"></i></button>
                      <button class="btn btn-sm btn-danger"
                        (click)="openDeleteItemConfirm(it.id)"><i
                          class="fa fa-trash"></i></button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- Item Form -->
            <div class="p-3">
              <form [formGroup]="itemForm" (ngSubmit)="submitItem()">
                <!-- <div class="row g-2"> -->
                <div class="mb-3">
                  <label class="form-label">Icon (FontAwesome class)</label>
                  <input class="form-control" formControlName="icon"
                    placeholder="fa-user" />
                </div>
                <div class="mb-3">
                  <label class="form-label">Subtitle</label>
                  <input class="form-control" formControlName="subtitle" />
                </div>
                <div class="mb-3">
                  <label class="form-label">Description</label>
                  <textarea class="form-control" formControlName="description"
                    rows="3"></textarea>
                </div>
                <div class="mb-3 d-flex align-items-end">
                  <div>
                    <div class="form-check mb-2">
                      <input class="form-check-input" type="checkbox"
                        formControlName="status" id="itemStatus" />
                      <label class="form-check-label"
                        for="itemStatus">Status</label>
                    </div>
                  </div>
                </div>
                <div class="d-flex justify-content-center align-items-center">
                  <button class="btn btn-primary btn-sm" type="submit">{{
                    editingItemId ? 'Update Item' : 'Add Item' }}</button>
                </div>
                <!-- </div> -->
              </form>
            </div>

            <!-- Delete confirm for items -->
            <div *ngIf="confirmDeleteItemId !== null"
              class="confirm-overlay mt-3">
              <div class="confirm-box">
                <p>Are you sure you want to delete this item?</p>
                <button (click)="confirmDeleteItem()"
                  class="btn btn-sm btn-success">Yes</button>
                <button (click)="cancelDeleteItem()"
                  class="btn btn-sm btn-danger">No</button>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
    <!-- ---------------- Items Modal End ---------------- -->

  </div>
</div>
