<!-- Contact Us Table -->
<div class="content">
    <div class="container-fluid pt-4 px-4">
        <h3>Contact Us Queries</h3>

        <div class="bg-secondary text-center rounded p-4 mt-3">
            <div class="d-flex justify-content-between mb-3">
                <h6>Contact Us List</h6>
                <button class="btn btn-sm btn-primary"
                    (click)="loadContactUslist()">Refresh</button>
            </div>

            <div class="table-responsive">
                <table class="table table-bordered table-hover">
                    <thead>
                        <tr class="text-white">
                            <th>#</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Subject</th>
                            <th>Message</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of contactuslist; let i=index">
                            <td>{{i+1}}</td>
                            <td>{{item.name}}</td>
                            <td>{{item.email}}</td>
                            <td>{{item.subject}}</td>
                            <td>{{item.message}}</td>
                            <td>{{item.status}}</td>
                            <td class="d-flex gap-2">
                                <button class="btn btn-sm btn-warning"
                                    (click)="viewContactUs(item)" title="View"><i
                                        class="fa fa-edit"></i></button>
                                <button
                                    *ngIf="item.status !== 'in_progress' && item.status !== 'resolved'"
                                    class="btn btn-sm btn-warning"
                                    (click)="openStatusConfirm(item.id, 'in_progress')" title="In Progress">
                                   <i class="fas fa-spinner"></i>
                                </button>
                                <button *ngIf="item.status !== 'resolved'"
                                    class="btn btn-sm btn-success"
                                    (click)="openStatusConfirm(item.id, 'resolved')" title="Resolve">
                                    <i class="fab fa-resolving"></i>
                                </button>
                                <button class="btn btn-sm btn-danger"
                                    (click)="openDeleteConfirm(item.id)"><i
                                        class="fa fa-trash"></i></button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- View Modal -->
    <div class="modal" [class.show]="showViewModal" *ngIf="showViewModal"
        style="display:block;">
        <div class="modal-dialog">
            <div class="modal-content bg-secondary p-3">
                <div class="modal-header">
                    <h5 class="modal-title">Contact Details</h5>
                    <button type="button" class="btn btn-outline-primary"
                        (click)="closeViewModal()">X</button>
                </div>
                <div class="modal-body contact-details-container">
                    <div class="contact-row">
                        <div class="contact-label"><i class="fas fa-user"></i>
                            Name:</div>
                        <div class="contact-value">{{ selectedContact?.name
                            }}</div>
                    </div>
                    <div class="contact-row">
                        <div class="contact-label"><i
                                class="fas fa-envelope"></i> Email:</div>
                        <div class="contact-value">{{ selectedContact?.email
                            }}</div>
                    </div>
                    <div class="contact-row">
                        <div class="contact-label"><i class="fas fa-book"></i>
                            Subject:</div>
                        <div class="contact-value">{{ selectedContact?.subject
                            }}</div>
                    </div>
                    <div class="contact-row">
                        <div class="contact-label"><i
                                class="fas fa-comment"></i> Message:</div>
                        <div class="contact-value message-block">{{
                            selectedContact?.message }}</div>
                    </div>
                    <div class="contact-row">
                        <div class="contact-label"><i
                                class="fas fa-info-circle"></i> Status:</div>
                        <div class="contact-value">
                            <span
                                [ngClass]="getStatusClass(selectedContact?.status)">
                                {{ selectedContact?.status | titlecase }}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Status confirmation modal -->
    <div *ngIf="confirmStatusId !== null" class="confirm-overlay">
        <div class="confirm-box">
            <p>Are you sure you want to mark this message as
                "{{ newStatus }}"?</p>
            <button (click)="confirmStatusUpdate()"
                class="btn btn-sm btn-success">Yes</button>
            <button (click)="cancelStatusUpdate()"
                class="btn btn-sm btn-danger">No</button>
        </div>
    </div>

    <!-- Delete Confirmation -->
    <div *ngIf="confirmDeleteId!==null" class="confirm-overlay">
        <div class="confirm-box p-3">
            <p>Are you sure to delete this message?</p>
            <button class="btn btn-success btn-sm"
                (click)="confirmDelete()">Yes</button>
            <button class="btn btn-danger btn-sm"
                (click)="cancelDelete()">No</button>
        </div>
    </div>

</div>
